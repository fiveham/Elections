<!DOCTYPE html>
<html>
  <head>
    <link rel="shortcut icon" href="https://raw.githubusercontent.com/fiveham/Elections/master/docs/images/nc-rwb-check.png">
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
    <meta property="og:image" content="http://raw.githubusercontent.com/fiveham/Elections/master/docs/images/nc03-special.png" />
    <meta property="og:image:url" content="http://raw.githubusercontent.com/fiveham/Elections/master/docs/images/nc03-special.png" />
    <meta property="og:image:secure_url" content="https://raw.githubusercontent.com/fiveham/Elections/master/docs/images/nc03-special.png" />
    <meta property="og:image:alt" content="A satelite image of eastern North Carolina overlaid by a semitransparent white polygon covering North Carolina's third congressional district and multicolored markers indicating election-day polling places." />
    <meta property="og:image:type" content="image/png" />
    <meta property="og:image:width" content="632" />
    <meta property="og:image:height" content="559" />
    <meta property="og:url" content="https://fiveham.github.io/Elections/2019/special/NC03.html" />
    <meta property="og:type" content="website" />
    <meta property="og:determiner" content="" />
    <meta property="og:title" content="NC-03 Congressional Special Election April 30th - Interactive Map" />
    <meta property="og:description" content="Interactive map of polling places and candidates for the 2019 special election in North Carolina's third congressional district." />
    
    <title>NC-03 Congressional Special Election April 30th - Interactive Map</title>
    
    <link rel="stylesheet" type="text/css" href="/Elections/css/fullpage-map.css">
    <link rel="stylesheet" type="text/css" href="/Elections/css/balloon-dimensions.css">
    <link rel="stylesheet" type="text/css" href="/Elections/css/balloon-guts.css">
    <link rel="stylesheet" type="text/css" href="/Elections/css/map-controls.css">
    <link rel="stylesheet" type="text/css" href="/Elections/css/geolocator.css">
    <link rel="stylesheet" type="text/css" href="/Elections/css/about-modal.css">
    <style>
      div.gm-style-iw > div.gm-style-iw-d > div > div > div:before {
        content: 'April 30th ';
      }
      div.gm-style-iw > div.gm-style-iw-d > div > div > div[style]:before, 
      div.gm-style-iw > div.gm-style-iw-d > div > div > div[style] ~ div:before {
        content: '';
      }
    </style>
  </head>
  <body>
    <!-- Geolocator Button -->
    <div id="geolocation" class="geolocate installed controls top" onclick="geolocate();" role="button" title="Go to your geolocation"></div>
    
    <!-- Voting Site Toggle Button -->
    <div id="pp-toggler" class="installed controls top text" onclick="pp_toggle()" role="button" title="Switch active polling place layer">
      <span id="pp-swap">Election Day Sites</span>
    </div>
    
    <!-- "About" Button -->
    <div id="about-btn" class="installed controls left bottom text" onclick="toggle_modal('about-modal')" role="button" 
         title="About this map">
      <span>About</span>
    </div>
    
    <!-- "About" Modal -->
    <div id="about-modal" class="installed">
      <div role="button" class="closer" onclick="toggle_modal('about-modal')">X</div>
      <div class="has-scrollbar">
        <div class="box" data-balloonish="dims guts">
          <div class="content">
            <p class="heading">Legend</p>
            <table>
              <tr><th class="center">Symbol</th><th>Site Type</th></tr>
              <tr>
                <td style="background-image: url('https://raw.githubusercontent.com/fiveham/Elections/master/docs/images/NC03-3.png');" 
                    title="The digit 3"></td>
                <td>One-Stop (Early) Voting Site</td></tr>
              <tr>
                <td style="background-image: url('http://maps.google.com/mapfiles/kml/paddle/purple-circle.png');" 
                    title="Blue, yellow, green, and purple map marker icons"></td>
                <td>Election-day polling places. Same county, same color.</td></tr>
            </table>
            <p class="heading">Candidates and Polling Places for the April 30th Election in NC's 3rd Congressional District</p>
            <p>The white background shape is the district (NC-03). When clicked, it'll pop up an infowindow listing the candidates, 
               each paired with their party affiliation, all arranged in a table. The rows of the table are sorted in alphabetical 
               order.</p>
            <p>Sites marked with a 3 are early voting sites, which allow an unregistered individual to register to vote and then to 
               immediately vote, provided that the person registering 
               <a href="https://www.ncsbe.gov/Voters/Registering-to-Vote#item5_3" target="_blank">brings proof of name and 
               address.</a></p>
            <p>Sites marked with a blue, yellow, green, or purple generic map marker are election-day (April 30th) polling places. 
               These are colored by county. Those in the same county have the same color, but each color is used by more than one 
               county.</p>
            <p class="heading">Note: Inaccuracies and Data Sources</p>
            <p>The locations, names, and addresses of these sites were obtained from the North Carolina State Board of Elections's 
               website, but individual counties are in charge of administering elections. It is possible that the state board's 
               information may not be up to date in some cases. If so, then the name, address, and/or website photos of one or more 
               polling places could be incorrect. <a href="https://vt.ncsbe.gov/BOEInfo">Contact your county board of elections</a> 
               if you need to make sure of the location, name, address, etc. of your (or someone else's) polling place.</p>
          </div>
        </div>
      </div>
    </div>
    
    <!-- The Map -->
    <div id="map"></div>
    
    <script>
      var map;
      var widgets; /* Create for global access, populate inside initMap */
      var layer, alt;
      var triggers = ["tilesloaded", "mousemove", "zoom_changed", "idle"];
      
      function initMap() {
        /* Populate widgets after google.maps is loaded */
        widgets = [{id: "geolocation", where: google.maps.ControlPosition.TOP_LEFT}, 
                   {id: "pp-toggler",  where: google.maps.ControlPosition.TOP_LEFT}, 
                   {id: "about-btn",   where: google.maps.ControlPosition.LEFT_BOTTOM},
                   {id: "about-modal", where: google.maps.ControlPosition.CENTER}];
        
        map = new google.maps.Map(document.getElementById('map'), {
          zoom: 8,
          center: {lat: 35.61215525049109, lng: -76.6224810408075},
          mapTypeId: 'hybrid'
        });
        
        var early = new google.maps.KmlLayer({
          url: 'http://fiveham.github.io/Elections/2019/special/ossite-nc03-30apr2019.kml',
          map: map,
          preserveViewport: true,
          zIndex: 1
        });
        
        var eday = new google.maps.KmlLayer({
          url: 'http://fiveham.github.io/Elections/2019/special/nc03_apr30.kml',
          map: null,
          preserveViewport: true,
          zIndex: 1
        });
        
        var nc03_outline = new google.maps.KmlLayer({
          url: 'http://fiveham.github.io/Elections/2019/special/nc03.kml',
          map: map,
          preserveViewport: false,
          zIndex: 0
        });
        
        /* Add geolocator button to the map itself */
        /*map.controls[google.maps.ControlPosition.TOP_LEFT].push(document.getElementById("geolocation"));*/
        
        /* Add layer-toggle to the map */
        /*map.controls[google.maps.ControlPosition.TOP_LEFT].push(document.getElementById("layer-select"));*/
        
        /* Change opacity of elements added to map to 1 */
        /*var triggers = ["tilesloaded","mousemove","zoom_changed","idle"];
        for(var i = 0; i < triggers.length; i++){
          google.maps.event.addListenerOnce(map, triggers[i], function(){
            document.getElementById("geolocation").style.opacity = "1";
            document.getElementById("layer-select").style.opacity = "1";
          });
        }*/
        
        /* Give real values to layer-pointers */
        layer = eday;
        alt = early;
        if((new Date()) < (new Date(2019, 4, 26, 19, 0, 0, 0))){
          pp_toggle();
        }
        layer.setMap(map);
        alt.setMap(null);
        
        add_widgets();
      }
      
      /* Add listed widgets to the map and make them visible (set opacity to 1) */
      /*function add_widgets(){
        widgets.forEach(function(widget){
          var element = document.getElementById(widget.id);
          map.controls[widget.where].push(element); // Add widget to the map 
          triggers.forEach(function(t){             // Make widget visible after any of the triggers 
            google.maps.event.addListenerOnce(map, t, function(){
              element.style.opacity = "1";          // Set opacity to 1 
            });
          });
        });
      }*/
      
      function pp_toggle(){
        var temp = alt;
        alt = layer;
        layer = temp;
        layer.setMap(map);
        alt.setMap(null);
        document.getElementById("pp-swap").innerHTML = (
            document.getElementById("pp-swap").innerHTML.startsWith("Early") 
            ? "Election Day Sites" 
            : "Early Voting Sites");
      }
      
      /*function toggle_modal(){
        var modal = document.getElementById("about-modal");
        modal.style.visibility = (modal.style.visibility == "visible" 
                                  ? "hidden" 
                                  : "visible");
      }*/
    </script>
    <script src="/Elections/js/geolocator.js"></script>
    <script src="/Elections/js/about-modal.js"></script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAQzE_F2ZqhXc_tIW4sfBOJBOsAKITo2JA&callback=initMap">
    </script>
  </body>
</html>
